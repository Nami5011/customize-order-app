{% liquid
  assign variant = product.selected_or_first_available_variant
  assign inventory_quantity = variant.inventory_quantity
  assign inventory_policy = variant.inventory_policy
  assign inventory_management = variant.inventory_management

  assign settings = block.settings
%}

{% if inventory_quantity <= 0 and inventory_management == 'shopify' and inventory_policy == 'continue' %}
  {% if settings.checkout_preorder_button_class != blank %}
    <style>
      .{{ settings.checkout_preorder_button_class | replace: '.', '' }} {
          background-color: {{ settings.checkout_button_color }}!important;
          color: {{ settings.checkout_text_color }}!important;
          border: {{ settings.checkout_border_thickness }}px solid!important;
          border-color: {{ settings.checkout_border_color }}!important;
      }
    </style>
  {% endif %}
  {% if settings.addcart_preorder_button_class != blank %}
    <style>
      .{{ settings.addcart_preorder_button_class | replace: '.', '' }} {
          background-color: {{ settings.addcart_button_color }}!important;
          color: {{ settings.addcart_text_color }}!important;
          border: {{ settings.addcart_border_thickness }}px solid!important;
          border-color: {{ settings.addcart_border_color }}!important;
      }
    </style>
  {% endif %}
{% endif %}

{% schema %}
{
  "name": "Pre Order Button Colour",
  "target": "section",
  "settings": [
    {
      "type": "header",
      "content": "Add to cart button"
    },
    {
      "type": "text",
      "id": "addcart_preorder_button_class",
      "label": "Add to cart button's css class name"
    },
    {
      "type": "color",
      "id": "addcart_button_color",
      "label": "Add to cart button colour",
      "default": "#000000"
    },
    { "type": "color", "id": "addcart_text_color", "label": "Add to cart text colour", "default": "#FFFFFF" },
    {
      "type": "number",
      "id": "addcart_border_thickness",
      "label": "addcart button border thickness (px)",
      "default": 1
    },
    {
      "type": "color",
      "id": "addcart_border_color",
      "label": "Add to cart button border colour",
      "default": "#000000"
    },

    {
      "type": "header",
      "content": "Dynamic checkout button"
    },
    {
      "type": "text",
      "id": "checkout_preorder_button_class",
      "label": "Checkout button's css class name"
    },
    {
      "type": "color",
      "id": "checkout_button_color",
      "label": "Checkout button colour",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "checkout_text_color",
      "label": "Checkout button text colour",
      "default": "#000000"
    },
    {
      "type": "number",
      "id": "checkout_border_thickness",
      "label": "Checkout button border thickness (px)",
      "default": 1
    },
    {
      "type": "color",
      "id": "checkout_border_color",
      "label": "Checkout button border colour",
      "default": "#000000"
    }
  ]
}
{% endschema %}
